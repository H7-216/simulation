<!DOCTYPE html>
<html lang="fr" class="antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DevTools Playground - Python, iMessage & Cards</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        primary: 'hsl(221, 83%, 53%)',
                        accent: 'hsl(262, 83%, 58%)',
                        background: '#ebecf0',
                    }
                }
            }
        }
    </script>

    <!-- Custom CSS (Neumorphism) -->
    <style>
        :root {
            --shadow-light: -5px -5px 10px #ffffff;
            --shadow-dark: 5px 5px 10px #babecc;
            --shadow-inset-light: inset -5px -5px 10px #ffffff;
            --shadow-inset-dark: inset 5px 5px 10px #babecc;
        }
        body { background-color: #ebecf0; }
        .neu-flat {
            background: #ebecf0;
            box-shadow: var(--shadow-dark), var(--shadow-light);
            border-radius: 1rem;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .neu-pressed {
            background: #ebecf0;
            box-shadow: var(--shadow-inset-dark), var(--shadow-inset-light);
            border-radius: 1rem;
        }
        .neu-btn {
            background: #ebecf0;
            box-shadow: var(--shadow-dark), var(--shadow-light);
            transition: all 0.3s ease;
        }
        .neu-btn:hover { transform: translateY(-2px); color: hsl(221, 83%, 53%); }
        .neu-btn:active { box-shadow: var(--shadow-inset-dark), var(--shadow-inset-light); transform: translateY(0); }
        .neu-btn-primary {
            background: linear-gradient(145deg, hsl(221, 83%, 53%), hsl(221, 83%, 43%));
            box-shadow: 5px 5px 10px rgba(59, 130, 246, 0.3), -5px -5px 10px #ffffff;
            color: white;
            transition: all 0.3s ease;
        }
        .neu-btn-primary:hover { transform: translateY(-2px); box-shadow: 6px 6px 12px rgba(59, 130, 246, 0.4), -6px -6px 12px #ffffff; }
        .neu-input {
            box-shadow: var(--shadow-inset-dark), var(--shadow-inset-light);
            background: transparent;
            outline: none;
            transition: all 0.2s ease;
        }
        .neu-input:focus { box-shadow: inset 6px 6px 12px #babecc, inset -6px -6px 12px #ffffff; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    </style>

    <!-- Scripts -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.30.0/index.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <!-- Pyodide for Local Python -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
</head>
<body class="font-sans antialiased text-slate-700 h-screen overflow-hidden">
    <div id="root" class="h-full"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const { motion, AnimatePresence } = FramerMotion;

        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); });
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        // --- COMPONENTS ---
        const CardVisual = ({ type, number, name, expiry, cvv }) => {
            const getGradient = () => {
                switch (type.toLowerCase()) {
                    case "visa": return "from-blue-600 to-blue-800";
                    case "mastercard": return "from-orange-500 to-red-600";
                    case "amex": return "from-slate-600 to-slate-800";
                    case "paypal": return "from-blue-500 to-cyan-500";
                    default: return "from-slate-700 to-slate-900";
                }
            };
            return (
                <motion.div
                    initial={{ rotateY: 90, opacity: 0 }}
                    animate={{ rotateY: 0, opacity: 1 }}
                    className={`relative w-full aspect-[1.586/1] rounded-2xl p-6 md:p-8 text-white shadow-2xl overflow-hidden bg-gradient-to-br ${getGradient()}`}
                >
                    <div className="relative z-10 flex flex-col justify-between h-full">
                        <div className="flex justify-between items-start">
                            <div className="w-12 h-8 bg-yellow-400/80 rounded-md" />
                            <h3 className="text-xl font-bold italic opacity-90">{type.toUpperCase()}</h3>
                        </div>
                        <div className="space-y-6">
                            <div className="text-xl md:text-2xl font-mono tracking-widest">{number || "•••• •••• •••• ••••"}</div>
                            <div className="flex justify-between items-end text-xs">
                                <div><p className="opacity-70 mb-1 uppercase">Card Holder</p><p className="font-mono">{name || "YOUR NAME"}</p></div>
                                <div className="text-right"><p className="opacity-70 mb-1 uppercase">Expires</p><p className="font-mono">{expiry || "MM/YY"}</p></div>
                            </div>
                        </div>
                    </div>
                </motion.div>
            );
        };

        // --- PAGES ---
        const Home = ({ setView }) => (
            <div className="space-y-12 animate-in fade-in slide-in-from-bottom-4 duration-500">
                <div className="space-y-4">
                    <h1 className="text-4xl md:text-6xl font-extrabold tracking-tight text-slate-800">
                        Developer <span className="text-primary">Playground</span>
                    </h1>
                    <p className="text-lg text-slate-500 max-w-2xl">
                        Une suite d'outils puissants avec un design neumorphique moderne. Exécutez du code, simulez des conversations et générez des données de test.
                    </p>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                    {[
                        { id: 'python', title: 'Python Terminal', desc: 'Exécutez du Python directement dans votre navigateur.', icon: 'terminal' },
                        { id: 'messages', title: 'iMessage Simulator', desc: 'Créez des captures d\'écran de conversations iOS réalistes.', icon: 'message-square' },
                        { id: 'cards', title: 'Card Generator', desc: 'Générez des visuels de cartes de crédit pour vos tests.', icon: 'credit-card' }
                    ].map(tool => (
                        <div key={tool.id} onClick={() => setView(tool.id)} className="neu-flat p-8 cursor-pointer group hover:-translate-y-2 transition-all">
                            <div className="w-14 h-14 rounded-2xl neu-pressed flex items-center justify-center mb-6 text-primary"><Icon name={tool.icon} size={28} /></div>
                            <h3 className="text-2xl font-bold mb-3">{tool.title}</h3>
                            <p className="text-slate-500 mb-6">{tool.desc}</p>
                            <div className="text-primary font-semibold flex items-center">Lancer l'outil <Icon name="arrow-right" size={16} className="ml-2" /></div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const PythonTerminal = () => {
            const [code, setCode] = useState('print("Hello from local Python!")\nimport math\nprint(f"Pi is {math.pi}")');
            const [output, setOutput] = useState("");
            const [isReady, setIsReady] = useState(false);
            const [executing, setExecuting] = useState(false);
            const pyodideRef = useRef(null);

            useEffect(() => {
                async function init() {
                    if (window.loadPyodide) {
                        pyodideRef.current = await window.loadPyodide();
                        setIsReady(true);
                    }
                }
                init();
            }, []);

            const run = async () => {
                if (!isReady) return;
                setExecuting(true);
                setOutput("");
                try {
                    await pyodideRef.current.runPythonAsync(`
import sys, io
sys.stdout = io.StringIO()
                    `);
                    const result = await pyodideRef.current.runPythonAsync(code);
                    const stdout = pyodideRef.current.runPython("sys.stdout.getvalue()");
                    setOutput(stdout + (result ? "\nReturn: " + result : ""));
                } catch (err) { setOutput(err.message); }
                finally { setExecuting(false); }
            };

            return (
                <div className="h-full flex flex-col gap-6">
                    <div className="flex justify-between items-center">
                        <h2 className="text-2xl font-bold flex items-center gap-2"><Icon name="terminal" className="text-primary" /> Python Terminal</h2>
                        <button onClick={run} disabled={!isReady || executing} className="neu-btn-primary px-6 py-2 rounded-xl flex items-center gap-2">
                            {executing ? <Icon name="loader-2" className="animate-spin" /> : <Icon name="play" />} {executing ? "Exécution..." : "Exécuter"}
                        </button>
                    </div>
                    <div className="flex-1 grid grid-rows-2 gap-6 min-h-0">
                        <textarea value={code} onChange={e => setCode(e.target.value)} className="neu-pressed p-6 font-mono text-sm resize-none outline-none custom-scrollbar" />
                        <div className="bg-[#1e1e1e] rounded-2xl p-6 font-mono text-green-400 overflow-auto whitespace-pre-wrap">
                            {output || <span className="text-slate-600">Console output...</span>}
                        </div>
                    </div>
                </div>
            );
        };

        const IMessageSimulator = () => {
            const [messages, setMessages] = useState([]);
            const [text, setText] = useState("");
            const [name, setName] = useState("Sarah");
            const [isMe, setIsMe] = useState(true);
            const phoneRef = useRef(null);

            const add = () => {
                if (!text.trim()) return;
                setMessages([...messages, { id: Date.now(), text, isMe, time: new Date() }]);
                setText("");
            };

            const download = async () => {
                const canvas = await html2canvas(phoneRef.current, { backgroundColor: '#ebecf0' });
                const link = document.createElement('a');
                link.download = `imessage-${name}.png`;
                link.href = canvas.toDataURL();
                link.click();
            };

            return (
                <div className="flex flex-col lg:flex-row gap-8 h-full">
                    <div className="w-full lg:w-96 flex flex-col gap-6 neu-flat p-6 overflow-y-auto">
                        <h3 className="font-bold text-lg">Configuration</h3>
                        <div className="space-y-4">
                            <div className="space-y-1">
                                <label className="text-xs font-bold text-slate-400 uppercase">Contact</label>
                                <input value={name} onChange={e => setName(e.target.value)} className="neu-input w-full p-3 rounded-xl" />
                            </div>
                            <div className="space-y-1">
                                <label className="text-xs font-bold text-slate-400 uppercase">Message</label>
                                <textarea value={text} onChange={e => setText(e.target.value)} className="neu-input w-full p-3 rounded-xl h-24 resize-none" />
                            </div>
                            <div className="flex gap-2">
                                <button onClick={() => setIsMe(true)} className={`flex-1 py-2 rounded-xl font-bold ${isMe ? 'neu-pressed text-primary' : 'neu-flat text-slate-400'}`}>Moi</button>
                                <button onClick={() => setIsMe(false)} className={`flex-1 py-2 rounded-xl font-bold ${!isMe ? 'neu-pressed text-slate-700' : 'neu-flat text-slate-400'}`}>Lui</button>
                            </div>
                            <button onClick={add} className="neu-btn-primary w-full py-3 rounded-xl font-bold">Ajouter Message</button>
                            <button onClick={download} className="neu-btn w-full py-3 rounded-xl font-bold border border-slate-200">Télécharger PNG</button>
                        </div>
                    </div>
                    <div className="flex-1 flex justify-center overflow-auto p-4">
                        <div ref={phoneRef} className="w-[360px] h-[720px] bg-black rounded-[50px] p-3 shadow-2xl relative border-[6px] border-[#1a1a1a] shrink-0">
                            <div className="w-full h-full bg-white rounded-[40px] overflow-hidden flex flex-col relative">
                                <div className="h-10 flex justify-center items-center"><div className="w-24 h-6 bg-black rounded-full" /></div>
                                <div className="p-4 border-b text-center"><p className="font-bold text-sm">{name}</p></div>
                                <div className="flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar">
                                    {messages.map(m => (
                                        <div key={m.id} className={`flex ${m.isMe ? 'justify-end' : 'justify-start'}`}>
                                            <div className={`max-w-[80%] p-3 rounded-2xl text-sm ${m.isMe ? 'bg-[#34c759] text-white' : 'bg-[#e9e9eb] text-black'}`}>{m.text}</div>
                                        </div>
                                    ))}
                                </div>
                                <div className="p-4 bg-slate-50 border-t flex gap-2"><div className="flex-1 h-8 bg-white border rounded-full px-3 text-xs flex items-center text-slate-300">iMessage</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const CardGenerator = () => {
            const [card, setCard] = useState({ type: 'visa', number: '4539 1234 5678 9012', name: 'JOHN DOE', expiry: '12/26' });
            const generate = () => {
                const types = ['visa', 'mastercard', 'amex', 'paypal'];
                const type = types[Math.floor(Math.random() * types.length)];
                setCard({
                    type,
                    number: Array.from({length:4}, () => Math.floor(1000 + Math.random() * 9000)).join(' '),
                    name: "GEN TESTER",
                    expiry: "09/28"
                });
            };
            return (
                <div className="max-w-4xl mx-auto space-y-12">
                    <div className="flex flex-col md:flex-row gap-12 items-center">
                        <div className="w-full md:w-1/2 space-y-6">
                            <h2 className="text-3xl font-bold">Card Visualizer</h2>
                            <p className="text-slate-500">Générez des visuels de cartes réalistes pour vos maquettes UI.</p>
                            <button onClick={generate} className="neu-btn-primary w-full py-4 rounded-2xl text-lg font-bold">Générer une Carte</button>
                        </div>
                        <div className="w-full md:w-1/2"><CardVisual {...card} /></div>
                    </div>
                </div>
            );
        };

        const Layout = ({ children, setView, activeView }) => {
            const items = [
                { id: 'home', label: 'Dashboard', icon: 'layout-grid' },
                { id: 'python', label: 'Python', icon: 'terminal' },
                { id: 'messages', label: 'iMessage', icon: 'message-square' },
                { id: 'cards', label: 'Cards', icon: 'credit-card' }
            ];
            return (
                <div className="h-full flex flex-col md:flex-row overflow-hidden">
                    <nav className="w-full md:w-20 lg:w-64 bg-background border-r border-white/20 p-4 flex md:flex-col gap-4">
                        <div className="hidden md:flex items-center gap-3 mb-8 px-2">
                            <div className="w-10 h-10 bg-primary rounded-xl flex items-center justify-center text-white"><Icon name="terminal" /></div>
                            <span className="font-bold text-xl hidden lg:block">DevTools</span>
                        </div>
                        {items.map(item => (
                            <div key={item.id} onClick={() => setView(item.id)} className={`flex items-center gap-4 p-3 rounded-xl cursor-pointer transition-all ${activeView === item.id ? 'neu-pressed text-primary font-bold' : 'text-slate-400 hover:text-slate-600'}`}>
                                <Icon name={item.icon} />
                                <span className="hidden lg:block text-sm">{item.label}</span>
                            </div>
                        ))}
                    </nav>
                    <main className="flex-1 overflow-y-auto p-6 md:p-12"><div className="max-w-7xl mx-auto h-full">{children}</div></main>
                </div>
            );
        };

        function App() {
            const [view, setView] = useState('home');
            return (
                <Layout setView={setView} activeView={view}>
                    {view === 'home' && <Home setView={setView} />}
                    {view === 'python' && <PythonTerminal />}
                    {view === 'messages' && <IMessageSimulator />}
                    {view === 'cards' && <CardGenerator />}
                </Layout>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
